$(document).ready(function(){$(".download-file").click(function(t){let e=$(this).data("id"),a=$(this).data("user-id"),s=$(this).data("score-user"),r=$(this).data("score-doc");if(s>r||s==r){let t=s-r;$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},type:"POST",url:"/download",data:{document_id:e,user_id:a},success:function(e){$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},type:"POST",url:"/update-score",data:{user_score:t},success:function(){toastr.success("Tải xuống thành công!","Thông báo")},error:function(){alert("Lỗi cập nhật điểm!")}})},error:function(){alert("Lỗi tải xuống!")}})}else t.preventDefault(),toastr.error("Không đủ điểm!","Thông báo")}),$(".btn-show__details-file").click(function(){let t=$(this).data("id"),e=$(this).data("user-id");$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},type:"POST",url:"/view",data:{document_id:t,user_id:e},error:function(){alert("Lỗi!")}})}),$(".btn-favourite").click(function(t){t.preventDefault();let e=$(this).data("id"),a=$(this).data("user-id");var s=$(this).find("i.icon-favourite");s.hasClass("text-danger")?s.removeClass("text-danger"):s.addClass("text-danger"),$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},type:"POST",url:"/favourite",data:{document_id:e,user_id:a},success:function(t){t.success&&toastr.success(t.message,"Thông báo")},error:function(){alert("Lỗi!")}})});let t=!1;$(".action-rate .star").click(function(){const e=20*($(this).index()+1);$(".action-rate .filled-stars").css("width",e+"%"),t=!0}),$(".btn-rate").click(function(){if(t){let t=$(this).data("doc-id"),a=$(this).data("user-id"),s=$(".filled-stars").attr("style").split(":")[1].trim();var e=parseInt(s,10);$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},type:"POST",url:"/rate",data:{document_id:t,user_id:a,rate:e},success:function(t){t.success&&toastr.success(t.message,"Thông báo")},error:function(){toastr.error("Lỗi đánh giá!","Thông báo")}})}else toastr.error("Chưa đánh giá tài liệu!","Thông báo")})});