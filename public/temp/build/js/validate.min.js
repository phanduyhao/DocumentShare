function validateForm(e){let t=!0;return $(e).find(".input-field").each(function(){let e=$(this).val(),n=$(this).attr("type");if($(this).removeClass("input-error"),"email"==n&&""!==e&&!isValidEmail(e)){t=!1,$(this).addClass("input-error");$(this).parent().append('<span class="helper text-danger" style="z-index: 999;margin-top: 75px;">Chưa nhập đúng kiểu email</span>')}if(null==e||""==e||void 0==e){t=!1,$(this).addClass("input-error");let e=`<span class="helper text-danger" style="z-index: 999;margin-top: 75px;">${$(this).data("require")}</span>`;$(this).parent().append(e)}}),t}function isValidEmail(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}function appendNewComment(e,t){var n=$(".my-avatar").attr("src"),i=new Date,a=i.getHours(),s=i.getMinutes(),o=i.getSeconds(),r=i.getDate(),m=i.getMonth()+1,l=i.getFullYear(),d=$('<div class="comments-users d-flex mb-4"><div class="comment-avata d-flex align-items-center justify-content-center me-3"><img width="50" class="rounded-circle" src="'+n+'" alt="Avatar"></div><div class="comment-user-info "><div class="comment-user-info-item"><a href="">'+e.user_name+'</a></div><div class="comment-user-info-item"><i class="fa-solid fa-calendar-days me-1"></i><span>'+l+"-"+m+"-"+r+" "+a+":"+s+":"+o+'</span></div><div class="comment-user-info-item"><p class="comment-user-desc m-0 mt-3">'+e.comment+'</p></div><div class="reply"><form id="boxCommentFormReply_'+e.id+'" class="comment-box child d-none bg-white p-3" data-action="http://documentmanage.test/sendComment"><p id="'+e.id+'" class="boxCommentFormReplyID d-none"></p><input type="hidden" name="_token" value="jmbwntWbDWzOKRBaCsvOPJtXzjTKp4tLhDcCXkq1" autocomplete="off"><input type="hidden" name="document" value="59"><input type="hidden" name="parent_comment_id" value="'+e.id+'"><div class="d-flex"><div class="comment-avata d-flex align-items-center justify-content-center me-2"><img width="50" class="rounded-circle" src="'+n+'" alt="Avatar"></div><div class="form-comment w-100"><textarea name="comment" class="input-field textarea-note w-100 p-3" rows="3" placeholder="Nhập bình luận *" data-require="Vui lòng nhập nội dung!"></textarea></div></div><button type="submit" class="send-comment float-end btn btn-primary">Gửi bình luận</button></form></div></div></div>');$(`.${t}`).prepend(d)}$("form .input-field").each(function(){$(this).click(function(){$(this).parent().find(".helper").remove(),$(this).removeClass("input-error")})}),$("body form").on("click",function(e){e.stopPropagation()}),$('#comment_area form button[type="submit"]').on("click",function(e){e.preventDefault();let t=$(this).closest("form"),n=t.attr("id"),i=t.data("action");if(validateForm(`#${n}`)){let e=t.serialize();$.ajax({type:"POST",url:i,data:e,success:function(e){toastr.success("Đã gửi bình luận!","Thông báo"),$(`#${n} input[type=text], #${n} input[type=email], #${n} textarea`).val("");var t=$("#"+n+" .boxCommentFormReplyID ").attr("id");"boxCommentForm"===n?appendNewComment(e,"comment-list"):n==="boxCommentFormReply_"+t&&appendNewComment(e,"comment-list__child-"+t)},error:function(){toastr.error("Lỗi bình luận!","Thông báo")}})}}),$("body").on("click",function(e){$(".helper").remove(),$(".input-error").removeClass("input-error")}),$(".reply-text__link").on("click",function(e){e.preventDefault(),$(".comment-box.child").addClass("d-none");$(this).closest(".comment-user").find(".comment-box.child").removeClass("d-none")});